define contact {
  name                            default-contact
  service_notification_period     24x7
  host_notification_period        24x7
  service_notification_options    w,u,c,r,f,s
  host_notification_options       d,u,r,f,s
  service_notification_commands   service-notify-by-email, service-notify-by-jabber
  host_notification_commands      host-notify-by-email, host-notify-by-sms-gateway, host-notify-by-jabber
  register                        0
}

define contact {
  name                            sms-contact
  service_notification_period     24x7
  host_notification_period        24x7
  service_notification_options    w,u,c,r,f,s
  host_notification_options       d,u,r,f,s
  service_notification_commands   service-notify-by-sms-gateway
  host_notification_commands      host-notify-by-sms-gateway
  register                        0
}

define host {
  name                            default-host
  notifications_enabled           1
  event_handler_enabled           1
  flap_detection_enabled          1
  failure_prediction_enabled      1
  process_perf_data               1
  retain_status_information       1
  retain_nonstatus_information    1
  notification_period             24x7
  register                        0
}

define host {
  name                    server
  use                     default-host
  check_period            24x7
  check_interval          <%= nagios_interval(nagios_attr(:default_host)[:check_interval]) %>
  retry_interval          <%= nagios_interval(nagios_attr(:default_host)[:retry_interval]) %>
  max_check_attempts      <%= nagios_attr(:default_host)[:max_check_attempts] %>
  check_command           check-host-alive
  notification_interval   <%= nagios_interval(nagios_attr(:default_host)[:notification_interval]) %>
  notification_options    d,u,r
  contact_groups          <%= nagios_attr(:default_contact_groups).join(",") %>
  register                0
}

define service {
  name                            default-service
  active_checks_enabled           1
  passive_checks_enabled          1
  parallelize_check               1
  obsess_over_service             1
  check_freshness                 0
  notifications_enabled           1
  event_handler_enabled           1
  flap_detection_enabled          1
  failure_prediction_enabled      1
  process_perf_data               1
  retain_status_information       1
  retain_nonstatus_information    1
  is_volatile                     0
  check_period                    24x7
  max_check_attempts              <%= nagios_attr(:default_service)[:max_check_attempts] %>
  check_interval                  <%= nagios_interval(nagios_attr(:default_service)[:check_interval]) %>
  retry_interval                  <%= nagios_interval(nagios_attr(:default_service)[:retry_interval]) %>
  contact_groups                  <%= nagios_attr(:default_contact_groups).join(",") %>
  notification_options            w,u,c,r
  notification_interval           <%= nagios_interval(nagios_attr(:default_service)[:notification_interval]) %>
  notification_period             24x7  
  register                        0
}

<% @node[:nagios][:templates].each do |name, params| %>
define <%= params[:template_type] %> {
  register  0
  <% params.each do |n, v| %>
  <% next if n == :template_type %>
  <%= n %>  <%= v %>
  <% end %>
}
<% end %>

# old templates


define contact{
        name                            generic-contact    	; The name of this contact template
        service_notification_period     24x7			; service notifications can be sent anytime
        host_notification_period        24x7			; host notifications can be sent anytime
        service_notification_options    w,u,c,r,f,s		; send notifications for all service states, flapping events, and scheduled downtime events
        host_notification_options       d,u,r,f,s		; send notifications for all host states, flapping events, and scheduled downtime events
        service_notification_commands   service-notify-by-email, service-notify-by-jabber ; send service notifications via email
        host_notification_commands      host-notify-by-email, host-notify-by-sms-gateway, host-notify-by-jabber	; send host notifications via email
        register                        0       		; DONT REGISTER THIS DEFINITION - ITS NOT A REAL CONTACT, JUST A TEMPLATE!
        }

define contact {
	name sms-contact
  service_notification_period     24x7			; service notifications can be sent anytime
  host_notification_period        24x7			; host notifications can be sent anytime
  service_notification_options    w,u,c,r,f,s		; send notifications for all service states, flapping events, and scheduled downtime events
  host_notification_options       d,u,r,f,s		; send notifications for all host states, flapping events, and scheduled downtime events
  service_notification_commands   service-notify-by-sms-gateway
  host_notification_commands      host-notify-by-sms-gateway
  register                        0       		; DONT REGISTER THIS DEFINITION - ITS NOT A REAL CONTACT, JUST A TEMPLATE!

}


define host{
        name                            generic-host    ; The name of this host template
        notifications_enabled           1       	; Host notifications are enabled
        event_handler_enabled           1       	; Host event handler is enabled
        flap_detection_enabled          1       	; Flap detection is enabled
        failure_prediction_enabled      1       	; Failure prediction is enabled
        process_perf_data               1       	; Process performance data
        retain_status_information       1       	; Retain status information across program restarts
        retain_nonstatus_information    1       	; Retain non-status information across program restarts
	notification_period		24x7		; Send host notifications at any time
        register                        0       	; DONT REGISTER THIS DEFINITION - ITS NOT A REAL HOST, JUST A TEMPLATE!
        }


define host{
	name				linux-server	; The name of this host template
	use				generic-host	; This template inherits other values from the generic-host template
	check_period			24x7		; By default, Linux hosts are checked round the clock
	check_interval			1		; Actively check the host every 5 minutes
	retry_interval			1		; Schedule host check retries at 1 minute intervals
	max_check_attempts		1		; Check each Linux host 10 times (max)
    check_command           	check-host-alive ; Default command to check Linux hosts
	notification_interval		20		; Resend notifications every 5 minutes
	notification_options		d,u,r		; Only send notifications for specific host states
	contact_groups			admins		; Notifications get sent to the admins by default
	register			0		; DONT REGISTER THIS DEFINITION - ITS NOT A REAL HOST, JUST A TEMPLATE!
	action_url			/nagios/pnp/index.php?host=$HOSTNAME
	}



define service{
        name                            generic-service 	; The 'name' of this service template
        active_checks_enabled           1       		; Active service checks are enabled
        passive_checks_enabled          1    		   	; Passive service checks are enabled/accepted
        parallelize_check               1       		; Active service checks should be parallelized (disabling this can lead to major performance problems)
        obsess_over_service             1       		; We should obsess over this service (if necessary)
        check_freshness                 0       		; Default is to NOT check service 'freshness'
        notifications_enabled           1       		; Service notifications are enabled
        event_handler_enabled           1       		; Service event handler is enabled
        flap_detection_enabled          1       		; Flap detection is enabled
        failure_prediction_enabled      1       		; Failure prediction is enabled
        process_perf_data               1       		; Process performance data
        retain_status_information       1       		; Retain status information across program restarts
        retain_nonstatus_information    1       		; Retain non-status information across program restarts
        is_volatile                     0       		; The service is not volatile
        check_period                    24x7			; The service can be checked at any time of the day
        max_check_attempts              3			; Re-check the service up to 3 times in order to determine its final (hard) state
        normal_check_interval           4			; Check the service every 10 minutes under normal conditions
        retry_check_interval            1			; Re-check the service every two minutes until a hard state can be determined
        contact_groups                  admins			; Notifications get sent out to everyone in the 'admins' group
		notification_options		w,u,c,r			; Send notifications about warning, unknown, critical, and recovery events
        notification_interval           80			; Re-notify about service problems every 20 minutes
        notification_period             24x7			; Notifications can be sent out at any time
         register                        0       		; DONT REGISTER THIS DEFINITION - ITS NOT A REAL SERVICE, JUST A TEMPLATE!
		action_url /nagios/pnp/index.php?host=$HOSTNAME$&srv=$SERVICEDESC$
 
       }



define service{
	name			local-service 		; The name of this service template
	use				generic-service		; Inherit default values from the generic-service definition
    max_check_attempts              4			; Re-check the service up to 4 times in order to determine its final (hard) state
        normal_check_interval           5			; Check the service every 5 minutes under normal conditions
        retry_check_interval            1			; Re-check the service every minute until a hard state can be determined
        register                        0       		; DONT REGISTER THIS DEFINITION - ITS NOT A REAL SERVICE, JUST A TEMPLATE!
	}

define service {
	name notify-on-critical
	use generic-service
	notification_options u,c,r
}

define service {
	name frequent-service
	use generic-service
	max_check_attempts              3			; Re-check the service up to 3 times in order to determine its final (hard) state
  normal_check_interval           1			; Check the service every 10 minutes under normal conditions
  retry_check_interval            1			; Re-check the service every two minutes until a hard state can be determined
}

