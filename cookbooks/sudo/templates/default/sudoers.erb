#
# /etc/sudoers
# 
# Generated by Chef for <%= @node[:fqdn] %>
# 

Defaults        !lecture,tty_tickets,!fqdn

# User privilege specification
root    			ALL=(ALL) ALL

<% @sudoers_groups.each do |group, conf| -%>
<% if conf[:enabled] %>
# Members of the group '<%= group %>' may gain root privileges
%<%= group %> ALL=(ALL) ALL
<% end -%>
<% end -%>

<% if @sudoers_users && !@sudoers_users.empty? %>
<% @sudoers_users.each do |user, conf| -%>
<%= user %> ALL=(<%= conf[:target_user] || "ALL" %>) <%= conf[:command] || "ALL" %>
<% end -%>
<% end %>

%app ALL=(app) ALL
%app ALL=(root) /bin/su - app

nobody  ALL=(app) NOPASSWD:/u/apps/backpack/current/script/email_helper
nobody  ALL=(app) NOPASSWD:/u/apps/basecamp/current/script/email_helper
nobody  ALL=(app) NOPASSWD:/u/apps/highrise/current/script/email_helper
nobody  ALL=(app) NOPASSWD:/u/apps/highrise/current/script/dropbox_helper